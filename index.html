<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alone Empty Together</title>
    <style>
        body { font-family: 'Arial', sans-serif; background: #f8f9fa; margin: 0; color: #333; padding-bottom: 180px; }
        .container { max-width: 800px; margin: 40px auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); }
        .logo { max-width: 280px; display: block; margin: 0 auto 20px; }
        .section { display: none; }
        .active { display: block; }
        .btn { padding: 15px 30px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; transition: 0.3s; text-align: center; display: inline-block; width: 100%; box-sizing: border-box; }
        .btn-start { background: #000; color: white; margin-top: 20px; }
        .btn-opt { background: #f1f3f5; text-align: left; margin: 8px 0; border: 1px solid #ddd; padding: 15px; width: 100%; color: #333; }
        .btn-opt:hover { background: #e2e6ea; }

        .result-display-box { background: #e7f5ff; border: 2px solid #228be6; padding: 30px; border-radius: 10px; margin-top: 20px; position: relative; }
        .blurred { filter: blur(18px); user-select: none; pointer-events: none; opacity: 0.4; }
        .locked-overlay { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; text-align: center; }
        .lock-badge { background: white; padding: 15px 25px; border-radius: 50px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 1px solid #ddd; font-size: 18px; }

        .float-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: white; box-shadow: 0 -5px 25px rgba(0,0,0,0.15); padding: 20px 0; z-index: 9999; text-align: center; display: none; }
        .btn-sub { background: #28a745; color: white; margin: 5px auto; width: 90%; max-width: 350px; display: block; }
        .btn-only { background: #007bff; color: white; margin: 5px auto; width: 90%; max-width: 350px; display: block; }
    </style>
</head>
<body>

<div class="container">
    <div id="intro" class="section active">
        <img src="logo.png" alt="Logo" class="logo">
        <p style="text-align:center;">Discover your attraction blueprint. Answer 20 questions to unlock your personalized result.</p>
        <button class="btn btn-start" onclick="startQuiz()">Continue</button>
    </div>

    <div id="quiz" class="section">
        <h2 id="q-title" style="text-align:center; min-height: 60px;"></h2>
        <div id="q-options"></div>
        <p id="q-progress" style="text-align:center; color: #888; margin-top: 20px;"></p>
    </div>

    <div id="result-preview" class="section">
        <h2 style="text-align:center;">Your Personal Analysis</h2>
        <div class="result-display-box">
            <div class="locked-overlay">
                <div class="lock-badge">üîí Result Locked</div>
            </div>
            <div id="preview-blur-wrapper" class="blurred">
                <div id="manifesto-preview-content"></div>
            </div>
        </div>
    </div>

    <div id="success-view" class="section">
        <h1 style="color: #28a745; text-align:center;">Access Granted! ‚úîÔ∏è</h1>
        <div class="result-display-box">
            <div id="final-result-content"></div>
        </div>
        <button class="btn btn-start" onclick="window.location.href='/'">Take the test again</button>
    </div>
</div>

<div id="footerBar" class="float-bar">
    <span style="display:block; margin-bottom:10px; font-weight:bold; font-size: 18px;">How do you want to unlock?</span>
    <button class="btn btn-sub" onclick="pay(true)">I want Results + Weekly Subscription ($3/mo)</button>
    <button class="btn btn-only" onclick="pay(false)">I want Only Results (One-time payment)</button>
</div>

<div id="data-store" style="display:none;">
    <div id="raw-bold">
        <h3>BOLD ‚Äì DIRECT ENERGY</h3>
        <p>You connect through energy, confidence, and clear intent. You don‚Äôt wait‚Äîyou take initiative and build chemistry fast.</p>
    </div>
    <div id="raw-calm">
        <h3>CALM ‚Äì COMFORT CREATOR</h3>
        <p>You attract by making people feel safe and seen. Your presence is grounding and conversations feel natural.</p>
    </div>
    <div id="raw-versatile">
        <h3>VERSATILE ‚Äì VIBE ADAPTER</h3>
        <p>You read the room fast and adapt your energy. You switch between humor and depth effortlessly.</p>
    </div>
    <div id="raw-elegant">
        <h3>ELEGANT ‚Äì TIMING & PRECISION</h3>
        <p>You move with intention. Your flirting is subtle, clean, and highly confident.</p>
    </div>
</div>

<script>
const questions = [
    { q: "What feels most natural when you talk to someone you like?", a: ["I jump in directly", "I stay calm and listen", "I mix styles depending on vibe", "I stay controlled and attentive"] },
    { q: "What is your biggest strength?", a: ["Confidence", "Empathy", "Adaptability", "Self-control"] },
    { q: "How do you like to gain interest?", a: ["Constant flirting", "Closeness", "Right moment", "Maturity"] },
    { q: "What kind of ‚Äòfirst move‚Äô fits you?", a: ["Direct and loud", "Slow and subtle", "Based on their reaction", "Calculated and clean"] },
    { q: "What pace do you prefer?", a: ["Fast", "Slow", "Variable", "Balanced"] },
    { q: "What do you focus on?", a: ["Chemistry", "Trust", "Social signals", "Timing"] },
    { q: "What‚Äôs your favorite ‚Äòzone‚Äô?", a: ["Teasing", "Personal talks", "Jokes & depth", "Classy dialogue"] },
    { q: "How do you handle emotions?", a: ["Show them openly", "Build them slowly", "Use them strategically", "Stay composed"] },
    { q: "What interactions excite you?", a: ["Vibe & teasing", "Honest talks", "Dynamic/Unpredictable", "Clear & classy"] },
    { q: "What best describes your mindset?", a: ["Bold", "Patient", "Versatile", "Disciplined"] },
    { q: "How do you set up a conversation?", a: ["Compliments", "Questions", "Switching topics", "Observing first"] },
    { q: "What‚Äôs your defense when panicking?", a: ["I joke/push", "I slow down", "I change tactics", "I stay silent/calm"] },
    { q: "What does a perfect date look like?", a: ["High energy", "Deep connection", "Mixed fun", "Respectful/Clean"] },
    { q: "How do you recover from awkwardness?", a: ["I joke it off", "I reset slowly", "I change direction", "I stay elegant"] },
    { q: "What feedback do you want?", a: ["'You are exciting'", "'You are special'", "'You are fun'", "'You are confident'"] },
    { q: "Energy management?", a: ["Intensity", "Steady rhythm", "Alternating", "Efficiency"] },
    { q: "What makes you 'dangerous'?", a: ["Charisma", "Presence", "Unpredictability", "Timing"] },
    { q: "What style do you admire?", a: ["Spontaneous", "Stable", "Balanced", "Elegant"] },
    { q: "When things go wrong...", a: ["Try harder", "Give space", "Change strategy", "Stay disciplined"] },
    { q: "What is your long-term goal?", a: ["Be irresistible", "Build connection", "Be natural", "Master communication"] }
];

const scoreKeys = ["bold", "calm", "versatile", "elegant"];
let current = 0;
let scores = { bold: 0, calm: 0, versatile: 0, elegant: 0 };

function navigate(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    window.scrollTo(0,0);
}

function startQuiz() {
    current = 0;
    scores = { bold: 0, calm: 0, versatile: 0, elegant: 0 };
    navigate('quiz');
    loadQ();
}

function loadQ() {
    if (current >= questions.length) {
        finishQuiz();
        return;
    }
    const q = questions[current];
    document.getElementById('q-title').innerText = q.q;
    document.getElementById('q-progress').innerText = `Question ${current + 1} of 20`;
    const container = document.getElementById('q-options');
    container.innerHTML = '';
    
    q.a.forEach((opt, index) => {
        const b = document.createElement('button');
        b.className = 'btn btn-opt';
        b.innerText = opt;
        b.onclick = () => {
            scores[scoreKeys[index]]++;
            current++;
            loadQ();
        };
        container.appendChild(b);
    });
}

function finishQuiz() {
    const winner = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
    localStorage.setItem("userResult", winner);
    document.getElementById('manifesto-preview-content').innerHTML = document.getElementById('raw-' + winner).innerHTML;
    navigate('result-preview');
    document.getElementById('footerBar').style.display = 'block';
}

function pay(isSubscribe) {
    const choice = localStorage.getItem("userResult") || "bold";
    // Redirectioneaza catre endpoint-ul tau de plata
    window.location.href = `/pay-session?subscribe=${isSubscribe}&choice=${choice}`;
}

window.onload = () => {
    const params = new URLSearchParams(window.location.search);
    if (params.has('session_id')) {
        const choice = localStorage.getItem("userResult") || "bold";
        navigate('success-view');
        document.getElementById('footerBar').style.display = 'none';
        document.getElementById('final-result-content').innerHTML = document.getElementById('raw-' + choice).innerHTML;
    }
};
</script>
</body>
</html>
